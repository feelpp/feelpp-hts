<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>HTS Bulk Cylinder in 2D coordinates :: Feelpp HTS</title>
    <link rel="canonical" href="https://feelpp.github.io/feelpp-hts/feelpp-hts/latest/cylinder/hform/cfpdes_2D.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../../_/css/site.css">
<link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">
<script>!function(l,p){if(l.protocol!==p&&l.host=="docs.antora.org"){l.protocol=p}else if(/\.gitlab\.io$/.test(l.host)){l.replace(p+"//docs.antora.org"+l.pathname.substr(l.pathname.indexOf("/",1))+l.search+l.hash)}}(location,"https:")</script>

<script src="../../../../_/js/vendor/tabs-block-extension.js"></script>
<script src="../../../../_/js/vendor/tabs-block-behavior.js"></script>

    <script type="text/javascript" src="../../../../_/js/vendor/visu-vtk.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/plotly.js-dist-min@2" charset="utf-8"></script>
  <script src="https://cdn.jsdelivr.net/npm/d3@7" charset="utf-8"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\\[','\\]']],
    processEscapes: true,
    processEnvironments: true,
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },

  TeX: {
      Macros: {
      RR: "{\\mathbb R}",
      NN: "{\\mathbb N}",
      Nso: "{N_{\\mathrm{so}}}",
      Nma: "{N_{\\mathrm{ma}}}",
      Nno: "{N_{\\mathrm{no}}}",
      Ne: "{N_{\\mathrm{e}}}",
      Ilag: ["{\\mathcal{I}^{\\mathrm{lag}}_{#1}}",1],
      calTh: "{\\mathcal{T}_h}",
      Ck: ["{\\mathcal{C}^{#1}}",1],
      Pk: ["{\\mathcal{P}^{#1}}",1],
      Qk: ["{\\mathcal{Q}^{#1}}",1],
      Pch: ["{P^{#1}_{c,h}}",1],
      Pcho: ["{P^{#1}_{c,h,0}}",1],
      Qch: ["{Q^{#1}_{c,h}}",1],
      Ich: ["{\\mathcal{I}^{#1}_{c,h}#2}",2],
      poly: ["{\\mathbb{#1}}",1],
      nf: "{n_f}",
      ngeo: "{n_{\\mathrm{geo}}}",
      geo: "{\\mathrm{geo}}",
      card: ["{\\operatorname{card}(#1)}",1],
      dim: ["{\\operatorname{dim}(#1)}",1],
      opdim: "{\\operatorname{dim}}",
      card: ["{\\operatorname{card}(#1)}",1],
      poly: ["{\\mathbb{#1}",1],
      R: ["{\\mathbb{R}^{#1}}",1],
      set: ["{\\left\\{#1\\right\\}}",1],
      diam: "{\\operatorname{diam}}",
      jump: ["{[\\![ #1 ]\\!]}",1],
      Next: "{\\mathrm{n}}",
      essinf: "{\\operatorname{ess}\\, \\operatorname{inf}}",
      tr: "{\\operatorname{tr}}",
      Id: "{\\mathcal{I}}",
      disp: ["{\\mathbf{#1}}",1],
      stresst: ["{\\mathbf{\\sigma(#1)}}",1],
      deformt: ["{\\mathbf{\\varepsilon(#1)}}",1],
      domain: "{\\Omega}",
      prect: ["{\\left\\(#1\\right\\)}",1],
      ds: "",
      bold: ["{\\bf #1}",1],
      p: "{\\mathrm{p}}",
      q:"{\\mathbf{q}}",
      n:"{\\mathbf{n}}",
      T:"{\\mathcal{T}}",
      F:"{\\mathcal{F}}",
      P:"{\\mathcal{P}}",
      v:"{\\mathbf{v}}"
  },
  extensions: ["mhchem.js"] }
});
</script>
<!--<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML"></script>-->
<!-- <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML' async></script> -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML'>
</script>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.0/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>-->

<!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css" integrity="sha384-TEMocfGvRuD1rIAacqrknm5BQZ7W7uWitoih+jMNFXQIbNl16bO8OZmylH/Vi/Ei" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.js" integrity="sha384-jmxIlussZWB7qCuB+PgKG1uLjjxbVVIayPJwi6cG6Zb4YKq0JIw+OMnkkEC7kYCq" crossorigin="anonymous"></script>-->
<script>var uiRootPath = '../../../../_'</script>

  </head>
  <body class="article">
<header class="header">
    <nav class="navbar navbar-expand-sm bg-dark navbar-dark navbar-template-project" style="border-top: 4px solid #9E9E9E">
        <div class="navbar-brand">
            <div class="navbar-item feelpp-logo">
                <a href="https://feelpp.github.io/feelpp-hts">Feelpp HTS</a>
            </div>
            <button class="navbar-burger" data-target="topbar-nav">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>

        <div id="topbar-nav" class="navbar-menu">
            <div class="navbar-end">
                <div class="navbar-item">
                    <a href="https://docs.feelpp.org/">Documentation Reference</a>
                </div>
                <div class="navbar-item">
                    <a class="navbar-brand"  href="https://www.cemosis.fr">
                        <img class="cemosis-logo"  src="../../../../_/img/cemosis-logo.svg" alt="Cemosis logo"/>
                    </a>
                </div>
            </div>
        </div>
    </nav>
</header>
<div class="body">
<a href="#" class="menu-expand-toggle"></a>
<div class="nav-container" data-component="feelpp-hts" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Feel++ Template Project</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../index.html">Feel++ hts</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../example.html#_cylinder">Cylinder</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">A-Formulation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../aform/cfpdes_axis.html">cfpdes axis</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../aform/cfpdes_2D_static.html">cfpdes 2D static</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">H-Formulation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="cfpdes_axis.html">cfpdes axis</a>
  </li>
  <li class="nav-item is-current-page" data-depth="4">
    <a class="nav-link" href="cfpdes_2D.html">cfpdes 2D</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../example.html#_roebel_cables">Roebel Cables</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">A-Formulation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../roebel/aform/cfpdes_2D_static.html">cfpdes 2D static</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../roebel/aform/cfpdes_axis_static.html">cfpdes axis static</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../example.html#_tapes">Tapes</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">T-A Homogeneous Formulation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../tapes/taform/cfpdes_axis.html">cfpdes axis</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../tapes/taform/cfpdes_2D.html">cfpdes 2D</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Feel++ Template Project</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
      <li class="component is-current">
        <a class="title" href="../../index.html">Feel++ Template Project</a>
          <ul class="versions">
              <li class="version is-current is-latest">
                <a href="../../index.html">latest</a>
              </li>
          </ul>
      </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
  <button class="nav-toggle"></button>
    <a href="../../index.html" class="home-link"></a>
  <nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Feel++ Template Project</a></li>
    <li><a href="../../index.html">Feel++ hts</a></li>
    <li><a href="../../example.html#_cylinder">Cylinder</a></li>
    <li>H-Formulation</li>
    <li><a href="cfpdes_2D.html">cfpdes 2D</a></li>
  </ul>
</nav>

  
    <div class="edit-this-page"><a href="https://github.com/feelpp/feelpp-hts/edit/master/docs/modules/ROOT/pages/cylinder/hform/cfpdes_2D.adoc">Edit this Page</a></div>
  
  <div class="page-downloads">
  <span class="label">Download as</span>
  <ul class="download-options">
    <li>
      <a onclick="print(this)" href="#" data-toggle="tooltip" data-placement="left" title="Print to PDF"
         class="pdf-download">
        <img class="pdf-file-icon icon" src="../../../../_/img/pdf.svg"/> .pdf
      </a>
    </li>
  </ul>
</div>
</div>

  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">HTS Bulk Cylinder in 2D coordinates</h1>
<div class="sect1">
<h2 id="_description"><a class="anchor" href="#_description"></a>1. Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>\(\quad\)In this example, we will build a magnetic model on a cylinder geometry surrounded by air in 2D coordinates. We will use the <strong>H Formulation</strong>.
Thus \(\Omega\) the domain contains the superconductor domain \(\Omega_c\) and non conducting materials \(\Omega_c^C\) (\(\mathbf{J} = 0\)) like the air for example. Also \(\Gamma = \partial \Omega\) is the bound of \(\Omega\), \(\Gamma_c = \partial \Omega_c\) the bound of \(\Omega_c\), \(\Gamma_D\) the bound with Dirichlet boundary condition and \(\Gamma_N\) the bound with Neumann boundary condition, such that \(\Gamma = \Gamma_D \cup \Gamma_N\).</p>
</div>
<div id="h_formulation" class="exampleblock">
<div class="title">H Formulation</div>
<div class="content">
<div class="stemblock">
<div class="content">
\[\text{(H)}
	\left\{ \begin{matrix}
		-\nabla\times \left(\rho \nabla\times \textbf{H}\right)&amp;=&amp;\partial_t(\mu \textbf{H}) &amp;\text{ on } \Omega &amp; \text{(H)} \\
		\mathbf{H} \times \mathbf{n} &amp;=&amp; 0 &amp;\text{ on } \Gamma_D &amp; \text{(D)} \\
		\left( \nabla \times \mathbf{H} \right) \times \mathbf{n} &amp;=&amp; 0 &amp;\text{ on } \Gamma_N &amp; \text{(N)}
	\end{matrix} \right.\]
</div>
</div>
<div class="paragraph">
<p>with \(\rho\) the resistivity following the <strong>E-J power law</strong> for the superconductor :</p>
</div>
<div class="stemblock">
<div class="content">
\[\rho=\frac{E_c}{J_c}\left(\frac{\mid\mid J \mid\mid}{J_c}\right)^{(n)}\]
</div>
</div>
<div class="paragraph">
<p>with :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>\(J_c\): the critical current density \((A/m^2)\)</p>
</li>
<li>
<p>\(E_c\): the threshold electric field \((V/m)\)</p>
</li>
<li>
<p>\(n\): material dependent exponent</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the air, we give the resistivity a high value like \(\rho_\text{air}=1\).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_running_the_case"><a class="anchor" href="#_running_the_case"></a>1.1. Running the case</h3>
<div class="paragraph">
<p>The command line to run this case is</p>
</div>
<div id="command-line" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sh hljs" data-lang="sh">mpirun -np 32 feelpp_toolbox_coefficientformpdes --config-file=cylinder_2D.cfg</code></pre>
</div>
</div>
<button class="btn" data-clipboard-target="#command-line">
Copy command line to clipboard
</button>
<table class="tableblock frame-all grid-all" style="width: 50%;">
<caption class="title">Table 1. Execution time</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Feelpp (parallel np 32)</th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tfoot>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">17.73 s</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tfoot>
</table>
</div>
<div class="sect2">
<h3 id="_equation"><a class="anchor" href="#_equation"></a>1.2. Equation</h3>
<div class="paragraph">
<p>The H Formulation in 2D coordinates is :</p>
</div>
<div class="exampleblock">
<div class="title">H Formulation in 2D coordinates</div>
<div class="content">
<div class="stemblock">
<div class="content">
\[\text{(H 2D)}
\left\{ \begin{matrix}
    \nabla\times\left(\rho\nabla\times H\right)  + \frac{\partial (\mu H)}{\partial t} &amp;=&amp; 0  &amp; \text{on } \Omega^{2D} &amp; \text{(H 2D)}\\
    \mathbf{H} \times \mathbf{n} &amp;=&amp; 0 &amp;\text{ on } \Gamma_D^{2D} &amp; \text{(D 2D)} \\
	\left( \nabla \times \mathbf{H} \right) \times \mathbf{n} &amp;=&amp; 0 &amp;\text{ on } \Gamma_N^{2D} &amp; \text{(N 2D)}
\end{matrix} \right.\]
</div>
</div>
<div class="paragraph">
<p>With :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>\(H\) : magnetic field</p>
</li>
<li>
<p>\(\rho\) : electric resistivity \(\Omega \cdot m\) described by the e-j power law :
\(\rho=\frac{E_c}{J_c}\left(\frac{\mid\mid J \mid\mid}{J_c}\right)^{(n)}=\frac{E_c}{J_c}\left(\frac{\mid\mid \nabla\times \textbf{H} \mid\mid}{J_c}\right)^{(n)}\)</p>
</li>
<li>
<p>\(\mu\) : electric permeability \(kg/A^2/S^2\)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>For the Dirichlet boundary conditions, we want to impose the applied magnetic field :</p>
</div>
<div class="paragraph">
<p>So we have \(B_z=hsVal\), therefore \(H_z = hsVal/\mu\).</p>
</div>
</div>
<div class="sect2">
<h3 id="_geometry"><a class="anchor" href="#_geometry"></a>1.3. Geometry</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Geometry with GMSH</caption>
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="image"><img src="../../_images/Cylinder/A-Formulation/cfpdes_2D/circle.png" alt="circle" width="600"></span></p>
</div></div></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Mesh with GMSH</caption>
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="image"><img src="../../_images/Cylinder/A-Formulation/cfpdes_2D/circlemesh.png" alt="circlemesh" width="600"></span></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_input"><a class="anchor" href="#_input"></a>2. Input</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Parameter table</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Notation</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Unit</th>
<th class="tableblock halign-left valign-top">Note</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="5"><p class="tableblock"><strong>Paramètres globale</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(H\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">magnetic field</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(A/m\)</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(bmax\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximal applied field</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(T\)</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(rate\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rate of the applied field raise</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\frac{3}{tf}b_{max}\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(T/s\)</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(hsVal\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">applied field</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\frac{1}{\mu_0}\begin{cases}rate*t &amp;\quad\text{if }t&lt;\frac{t_f}{3}\\b_{max} &amp;\quad\text{if }t&lt;\frac{2t_f}{3}\\b_{max} - (t-\frac{2t_f}{3})*rate &amp;\quad\text{if }t&gt;\frac{2t_f}{3}\end{cases}\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(K\)</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="5"><p class="tableblock"><strong>Air</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\mu=\mu_0\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">magnetic permeability of vacuum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(4\pi.10^{-7}\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(kg \, m / A^2 / S^2\)</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\rho\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">electrical resistivity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(1\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\Omega\cdot m\)</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="5"><p class="tableblock"><strong>Cylinder</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\mu=\mu_0\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">magnetic permeability of vacuum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(4\pi.10^{-7}\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(kg \, m / A^2 / S^2\)</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(J_c\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">critical current density</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(3.10^8\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(A/m^2\)</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(E_c\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">threshold electric field</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(10^{-4}\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(V/m\)</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(n\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">material dependent exponent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(20\)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
<tfoot>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\rho\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">electrical resistivity (described by the \(e-j\) power law)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\frac{E_c}{J_c}\left(\frac{\mid\mid J \mid\mid}{J_c}\right)^{(n)}\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\Omega\cdot m\)</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tfoot>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_data_files"><a class="anchor" href="#_data_files"></a>3. Data files</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The case data files are available in Github <a href="https://github.com/feelpp/feelpp-hts/blob/master/src/cases/Cylinder/H-Formulation/cfpdes_2D">here</a></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/feelpp/feelpp-hts/blob/master/src/cases/Cylinder/H-Formulation/cfpdes_2D/cylinder_2D.cfg">CFG file</a> - [<a href="https://github.com/feelpp/feelpp-hts/edit/master/src/cases/Cylinder/H-Formulation/cfpdes_2D/cylinder_2D.cfg">Edit the file</a>]</p>
</li>
<li>
<p><a href="https://github.com/feelpp/feelpp-hts/blob/master/src/cases/Cylinder/H-Formulation/cfpdes_2D/cylinder_2D.json">JSON file</a> - [<a href="https://github.com/feelpp/feelpp-hts/edit/master/src/cases/Cylinder/H-Formulation/cfpdes_2D/cylinder_2D.json">Edit the file</a>]</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_json_file"><a class="anchor" href="#_json_file"></a>3.1. Json file</h3>
<div class="sect3">
<h4 id="_mesh"><a class="anchor" href="#_mesh"></a>3.1.1. Mesh</h4>
<div class="paragraph">
<p>This section of the Model JSON file setup the mesh.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"Meshes":
    {
        "cfpdes":
        {
            "Import":
            {
                "filename":"$cfgdir/circle.geo"<i class="conum" data-value="1"></i><b>(1)</b>
            }
        }
    },</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>the geometric file</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_materials"><a class="anchor" href="#_materials"></a>3.1.2. Materials</h4>
<div class="paragraph">
<p>This section of the Model JSON file defines material properties linking the Physical Entities in the mesh data structures to these properties.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"Materials":
    {
        "Conductor":<i class="conum" data-value="1"></i><b>(1)</b>
        {
            "markers":["Conductor"],<i class="conum" data-value="1"></i><b>(1)</b>

            "rho":"ec / jc * (abs(magnetic_curl_H_rt)/jc)^(n - 1):ec:jc:n:magnetic_curl_H_rt",<i class="conum" data-value="2"></i><b>(2)</b>
	        "mu":"mu0:mu0"
        },
        "Air":<i class="conum" data-value="1"></i><b>(1)</b>
        {
	        "markers":["Air"],<i class="conum" data-value="1"></i><b>(1)</b>

            "rho":1,
	        "mu":"mu0:mu0"
        }
    },</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>gives the name of the physical entity (here <code>Physical Surface</code>) associated to the Material.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>\(\rho\)  is defined by the E-J power law in the HTS</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_models"><a class="anchor" href="#_models"></a>3.1.3. Models</h4>
<div class="paragraph">
<p>This section of the Model JSON file defines material properties linking the Physical Entities in the mesh data structures to these properties.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"Models":<i class="conum" data-value="1"></i><b>(1)</b>
    {
        "cfpdes":{
            "equations":"magnetic"<i class="conum" data-value="2"></i><b>(2)</b>
        },
        "magnetic":<i class="conum" data-value="3"></i><b>(3)</b>
        {
            "name": "magnetic_conductor",
            "setup":{
                "unknown":{
                    "basis":"Ned1h0",<i class="conum" data-value="4"></i><b>(4)</b>
                    "name":"H",<i class="conum" data-value="5"></i><b>(5)</b>
                    "symbol":"H"<i class="conum" data-value="6"></i><b>(6)</b>
                },
                "coefficients":{<i class="conum" data-value="7"></i><b>(7)</b>
                    "zeta":"materials_rho:materials_rho",
                    "d":"materials_mu:materials_mu"
                }
            }
        }
    },</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>start section <code>Models</code> defined by the toolbox to define the main configuration and particularly the set of equations to be solved</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>set of equations to be solved</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>toolbox keyword that allows identifying the kind of model</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>equation unknown&#8217;s basis</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>equation unknown&#8217;s name</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>equation unknown&#8217;s symbol</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>CFPDES coefficients</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_boundary_conditions"><a class="anchor" href="#_boundary_conditions"></a>3.1.4. Boundary Conditions</h4>
<div class="paragraph">
<p>This section of the Model JSON file defines the boundary conditions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"BoundaryConditions":
    {
        "magnetic": <i class="conum" data-value="1"></i><b>(1)</b>
        {
            "Dirichlet": <i class="conum" data-value="2"></i><b>(2)</b>
            {
                "magdir":
                {
                    "markers":["Infty"], <i class="conum" data-value="3"></i><b>(3)</b>
                    "expr":"{0,hsVal}:hsVal"
                }
            }
        }
    },</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>the field name of the toolbox to which the boundary condition is associated</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>the type of boundary condition to apply, here <code>Dirichlet</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>the physical entity (associated to the mesh) to which the condition is applied</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_post_process"><a class="anchor" href="#_post_process"></a>3.1.5. Post Process</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"PostProcess":
    {
        "use-model-name":1,
        "magnetic":<i class="conum" data-value="1"></i><b>(1)</b>
        {
            "Exports":<i class="conum" data-value="2"></i><b>(2)</b>
            {
                "fields":["H"],<i class="conum" data-value="3"></i><b>(3)</b>
                "expr":<i class="conum" data-value="4"></i><b>(4)</b>
                {
                    "B":<i class="conum" data-value="5"></i><b>(5)</b>
                    {
                        "expr":"{materials_mu*magnetic_H_0,materials_mu*magnetic_H_1}:materials_mu:magnetic_H_0:magnetic_H_1",
                        "representation":["element"]
                    },
                    "J":<i class="conum" data-value="6"></i><b>(6)</b>
                    {
                        "expr":"magnetic_curl_H:magnetic_curl_H",
                        "markers":["Cylinder"]<i class="conum" data-value="7"></i><b>(7)</b>
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>the field name of the toolbox to which the post-processing is associated</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>the <code>Exports</code> identifies the toolbox fields that have to be exported for visualisation</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>the list of fields to be exported</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>the list of expressions assiocated to the fields to be exported</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td><code>B</code> is for the magnetic flux density</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td><code>J</code> is for the current density</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>the physical entity (associated to the mesh) to which the expression is applied</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cfg_file"><a class="anchor" href="#_cfg_file"></a>3.2. CFG file</h3>
<div class="paragraph">
<p>The Model CFG (<code>.cfg</code>) files allow to pass command line options to Feel++ applications. In particular, it allows to  define the solution strategy and configure the linear/non-linear algebraic solvers.</p>
</div>
<div class="paragraph">
<p>The Cfg file used is</p>
</div>
<div class="listingblock">
<div class="content">
<pre>directory=feelpp-hts/cylinder/Hform/cfpdes_2D<i class="conum" data-value="1"></i><b>(1)</b>

case.dimension=2<i class="conum" data-value="2"></i><b>(2)</b>

[cfpdes]<i class="conum" data-value="3"></i><b>(3)</b>
filename=$cfgdir/cylinder_2D.json<i class="conum" data-value="4"></i><b>(4)</b>

verbose_solvertimer=1<i class="conum" data-value="5"></i><b>(5)</b>
solver=Newton<i class="conum" data-value="6"></i><b>(6)</b>

ksp-monitor=1<i class="conum" data-value="7"></i><b>(7)</b>
ksp-view=1
ksp-converged-reason=1<i class="conum" data-value="8"></i><b>(8)</b>

snes-type=ls
snes-line-search-type=bt
snes-monitor=1
snes-view=1
snes-maxit=200<i class="conum" data-value="9"></i><b>(9)</b>
snes-atol=1.e-5<i class="conum" data-value="10"></i><b>(10)</b>
#snes-rtol=1.e-6<i class="conum" data-value="11"></i><b>(11)</b>
snes-converged-reason=1

pc-factor-mumps.icntl-14=200

[cfpdes.magnetic]<i class="conum" data-value="12"></i><b>(12)</b>
bdf.order=2<i class="conum" data-value="13"></i><b>(13)</b>

[ts]<i class="conum" data-value="14"></i><b>(14)</b>
time-initial=0<i class="conum" data-value="15"></i><b>(15)</b>
time-step=0.5<i class="conum" data-value="16"></i><b>(16)</b>
time-final=15<i class="conum" data-value="17"></i><b>(17)</b>
restart.at-last-save=true<i class="conum" data-value="18"></i><b>(18)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>the directory where the results are exported</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>the dimension of the application, by default 3D</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>toolbox prefix</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>the associated Json file</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>information on solver time</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>the non-linear solver</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>ksp-monitor</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>ksp-converged-reason</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>maximum number of iteration</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>snes absolute tolerance</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>snes relative tolerance</td>
</tr>
<tr>
<td><i class="conum" data-value="12"></i><b>12</b></td>
<td>cfpdes.magnetic</td>
</tr>
<tr>
<td><i class="conum" data-value="13"></i><b>13</b></td>
<td>cfpdes.magnetic order</td>
</tr>
<tr>
<td><i class="conum" data-value="14"></i><b>14</b></td>
<td>time setup</td>
</tr>
<tr>
<td><i class="conum" data-value="15"></i><b>15</b></td>
<td>time initial</td>
</tr>
<tr>
<td><i class="conum" data-value="16"></i><b>16</b></td>
<td>time step</td>
</tr>
<tr>
<td><i class="conum" data-value="17"></i><b>17</b></td>
<td>time final</td>
</tr>
<tr>
<td><i class="conum" data-value="18"></i><b>18</b></td>
<td>restart at last save</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_result"><a class="anchor" href="#_result"></a>4. Result</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_electric_current_density"><a class="anchor" href="#_electric_current_density"></a>4.1. Electric current density</h3>
<div class="videoblock">
<div class="title">Electric current density \(J (A/m^2)\)</div>
<div class="content">
<iframe width="720" height="400" src="https://www.youtube.com/embed/uYFO9JJlgDI?rel=0" frameborder="0" allowfullscreen></iframe>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_magnetic_flux_density"><a class="anchor" href="#_magnetic_flux_density"></a>4.2. Magnetic flux density</h3>
<div class="videoblock">
<div class="title">Magnetic flux density \(B (T)\)</div>
<div class="content">
<iframe width="720" height="400" src="https://www.youtube.com/embed/OF71o5rjNn4?rel=0" frameborder="0" allowfullscreen></iframe>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_interactive_view"><a class="anchor" href="#_interactive_view"></a>4.3. Interactive view</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><div class="content"><div id="vtkjs_fed5e862-1534-4f6d-8373-c1a7373253ff" style="height: 500px; width: 100%;"></div>
<script>
feelppVtkJs.createSceneImporter("vtkjs_fed5e862-1534-4f6d-8373-c1a7373253ff", {
  fileURL: "https://girder.math.unistra.fr/api/v1/item/64ca6183b0e9570499e1cc94/download",
  objects: {
  "fields": [
    {
      "scene": "magfield",
      "name": "Magnetic Field B"
    },
    {
      "scene": "currden",
      "name": "Current Density J"
    }
  ]
}
})
</script></div></td>
<td class="tableblock halign-center valign-top"><div class="content"><div id="vtkjs_1e390f5b-7880-4b3b-9a19-491e685d58fd" style="height: 500px; width: 100%;"></div>
<script>
feelppVtkJs.createSceneImporter("vtkjs_1e390f5b-7880-4b3b-9a19-491e685d58fd", {
  fileURL: "https://girder.math.unistra.fr/api/v1/item/64ca6183b0e9570499e1cc91/download",
  objects: {
  "fields": [
    {
      "scene": "magfield",
      "name": "Magnetic Field B"
    },
    {
      "scene": "currden",
      "name": "Current Density J"
    }
  ]
}
})
</script></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><div class="content"><div class="paragraph">
<p>\(t=5s\)</p>
</div></div></td>
<td class="tableblock halign-center valign-top"><div class="content"><div class="paragraph">
<p>\(t=10s\)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><div class="content"><div id="vtkjs_fa4ffdc7-b2d7-4eac-b4d9-33bea5c4065e" style="height: 500px; width: 100%;"></div>
<script>
feelppVtkJs.createSceneImporter("vtkjs_fa4ffdc7-b2d7-4eac-b4d9-33bea5c4065e", {
  fileURL: "https://girder.math.unistra.fr/api/v1/item/64ca6183b0e9570499e1cc8e/download",
  objects: {
  "fields": [
    {
      "scene": "magfield",
      "name": "Magnetic Field B"
    },
    {
      "scene": "currden",
      "name": "Current Density J"
    }
  ]
}
})
</script></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>\(t=15s\)</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer" style="border-top: 2px solid #e9e9e9; background-color: #fafafa; padding-bottom: 2em; padding-top: 2em;">
    <div class="container" style="display: flex; flex-direction: column; align-items: center; gap: 0.5em;">
        <div>
            <a href="https://www.cemosis.fr">
                <img src="../../../../_/img/cemosis-logo.svg" alt="Cemosis logo" height="50">
            </a>
        </div>
        <span style="font-size: 0.8rem; color: #9e9e9e">© 2023 <a href="https://www.cemosis.fr" style="text-decoration: underline;">Cemosis</a>, Université de Strasbourg</span>
    </div>
</footer>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>


<script async src="../../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script async src="../../../../_/js/vendor/fontawesome.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>


<script type="text/javascript">
function toggleFullScreen() {
   var doc = window.document;
   var docEl = doc.documentElement;

   var requestFullScreen = docEl.requestFullscreen || docEl.mozRequestFullScreen || docEl.webkitRequestFullScreen || docEl.msRequestFullscreen;
   var cancelFullScreen = doc.exitFullscreen || doc.mozCancelFullScreen || doc.webkitExitFullscreen || doc.msExitFullscreen;

   if(!doc.fullscreenElement && !doc.mozFullScreenElement && !doc.webkitFullscreenElement && !doc.msFullscreenElement) {
       requestFullScreen.call(docEl);
   }
   else {
       cancelFullScreen.call(doc);
   }
}
</script>
  </body>
</html>
